@model EyelixEyewear_Project.Models.ViewModels.CartViewModel
@{
    ViewBag.Title = "Shopping Cart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    <link rel="stylesheet" href="~/css/cart.css" asp-append-version="true" />
}

<div class="cart-page">
    <div class="cart-layout">
        @if (Model.CartItems != null && Model.CartItems.Any())
        {
            <h1 class="cart-title">Shopping Cart</h1>

            <div class="cart-grid">
                <!-- LEFT: Cart Items Table -->
                <div class="cart-items-section">
                    <!-- Table Header -->
                    <div class="cart-table-header">
                        <span>Product</span>
                        <span>Quantity</span>
                        <span>Subtotal</span>
                        <span></span>
                    </div>

                    <!-- Cart Items -->
                    @foreach (var item in Model.CartItems)
                    {
                        <div class="cart-item">
                            <div class="cart-item-left">
                                <img src="@item.ProductImage"
                                     alt="@item.ProductName"
                                     class="cart-thumb"
                                     onerror="this.src='/images/default.png'">
                                <div class="cart-info">
                                    <div class="name">@item.ProductName</div>
                                    <div class="price">
                                        @item.Price.ToString("N0") VND
                                        @if (item.Product?.Price > item.Price)
                                        {
                                            <span style="text-decoration: line-through; color: #999; margin-left: 8px;">
                                                @item.Product.Price.ToString("N0") VND
                                            </span>
                                            <span style="color: #E53935; margin-left: 5px;">VAT</span>
                                        }
                                    </div>
                                </div>
                            </div>

                            <div class="quantity-box">
                                <button class="qty-btn minus" data-product-id="@item.ProductId">−</button>
                                <input type="text"
                                       class="qty-input"
                                       value="@item.Quantity"
                                       data-product-id="@item.ProductId"
                                       readonly>
                                <button class="qty-btn plus" data-product-id="@item.ProductId">+</button>
                            </div>

                            <div class="cart-subtotal">
                                @((item.Price * item.Quantity).ToString("N0")) VND
                            </div>

                            <div class="cart-remove">
                                <button class="remove-item"
                                        data-product-id="@item.ProductId"
                                        title="Remove">
                                    ×
                                </button>
                            </div>
                        </div>
                    }
                </div>

                <!-- RIGHT: Cart Totals -->
                <div class="cart-summary">
                    <h2>Cart totals</h2>

                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span>@Model.Subtotal.ToString("N0") VND</span>
                    </div>

                    <div class="summary-row" style="border-top: 1px solid #ddd; padding-top: 15px; margin-top: 5px;">
                        <span style="font-weight: 600;">Shipping</span>
                        <div></div>
                    </div>

                    <p class="vat-info">(includes @(((Model.Subtotal + 20000) * 0.08m).ToString("N0")) VND VAT)</p>

                    <a href="@Url.Action("Checkout", "Order")" class="btn-checkout">
                        Proceed to checkout
                    </a>
                </div>
            </div>
        }
        else
        {
            <!-- Empty Cart -->
            <div style="text-align: center; padding: 100px 20px;">
                <div style="font-size: 80px; margin-bottom: 20px;">🛒</div>
                <h2 style="font-size: 28px; margin-bottom: 10px;">Your cart is empty</h2>
                <p style="color: #777; margin-bottom: 30px;">Looks like you haven't added any items yet.</p>
                <a href="@Url.Action("Index", "Product")"
                   style="display: inline-block; padding: 12px 40px; background: #000; color: white; border-radius: 8px; text-decoration: none;">
                    Start Shopping
                </a>
            </div>
        }
    </div>
</div>
}